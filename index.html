<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hatyai Songthaew Live | ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏ñ‡∏™‡∏≠‡∏á‡πÅ‡∏ñ‡∏ß‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà</title>

    <!-- Meta for SEO -->
    <meta name="description"
        content="‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏ñ‡∏™‡∏≠‡∏á‡πÅ‡∏ñ‡∏ß‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏ö‡∏ö Real-time ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏¥‡∏Å‡∏±‡∏î ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏≤‡∏ñ‡∏∂‡∏á ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£">
    <meta name="keywords" content="‡∏£‡∏ñ‡∏™‡∏≠‡∏á‡πÅ‡∏ñ‡∏ß‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà, ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏ñ, ‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà, Hatyai Songthaew">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Role Selector Overlay - ‡∏°‡πà‡∏≤‡∏ô‡∏ö‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î -->
    <div id="role-overlay" class="role-overlay">
        <img src="logo.png" alt="Logo" style="width: 100px; border-radius: 20px; margin-bottom: 20px;">
        <h1 style="font-size: 2.5rem; color: var(--dark); margin-bottom: 10px;">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà Hatyai Live</h1>
        <p style="font-size: 1.1rem; color: #636366; margin-bottom: 30px;">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏ñ‡∏™‡∏≠‡∏á‡πÅ‡∏ñ‡∏ß‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ (Demo)</p>
        <div class="role-container">
            <button class="role-btn passenger" onclick="setRole('passenger')">
                <span style="font-size: 2rem;">üë§</span>
                ‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£
            </button>
            <button class="role-btn driver" onclick="setRole('driver')">
                <span style="font-size: 2rem;">üõ∫</span>
                ‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ
            </button>
        </div>
    </div>

    <!-- Driver Notification -->
    <div id="driver-notif" class="driver-notif">
        üîî ‡∏°‡∏µ‡∏Ñ‡∏ô‡∏Å‡∏î‡∏Å‡∏£‡∏¥‡πà‡∏á! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏à‡∏≠‡∏î‡∏£‡∏±‡∏ö/‡∏™‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢
        <button onclick="dismissNotif()"
            style="margin-left:10px; border:none; background:white; border-radius:10px; padding:2px 10px; color:red; cursor:pointer;">‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö</button>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="header">
            <div class="logo-container">
                <img src="logo.png" alt="Hatyai Songthaew Live Logo"
                    style="width: 50px; height: 50px; border-radius: 12px; object-fit: cover;">
                <div>
                    <h1 id="app-title">Hatyai Live</h1>
                    <p id="app-subtitle">Songthaew Tracking System</p>
                </div>
            </div>
            <p id="role-text">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏¢‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</p>
        </div>

        <div class="route-selector">
            <h2 class="section-title">‡∏™‡∏≤‡∏¢‡∏£‡∏ñ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
            <div id="route-list">
                <!-- Route cards will be injected by JavaScript -->
            </div>

            <!-- Route Timeline (Visible when selected) -->
            <div id="route-timeline-container" class="hidden"
                style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 16px;">
                <p style="font-size: 0.8rem; font-weight: 600; color: #8E8E93; margin-bottom: 15px;">‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ:</p>
                <div id="timeline" class="timeline">
                    <!-- Steps will be injected here -->
                </div>
            </div>

            <!-- Driver Dashboard (Visible only for Drivers) -->
            <div id="driver-dashboard" class="hidden"
                style="margin-top: 20px; padding: 15px; background: var(--dark); color: white; border-radius: 16px;">
                <p style="font-size: 0.9rem; font-weight: 500; margin-bottom: 12px; color: var(--secondary);">üìä
                    ‡πÅ‡∏ú‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (IoT Dashboard)</p>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <span style="font-size: 0.8rem; opacity: 0.8;">‡∏ú‡∏π‡πâ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ:</span>
                    <span id="driver-passenger-count" style="font-weight: 600; color: var(--secondary);">0 ‡∏Ñ‡∏ô</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span style="font-size: 0.8rem; opacity: 0.8;">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£:</span>
                    <span id="driver-revenue" style="font-weight: 600; color: var(--success);">0 ‡∏ö‡∏≤‡∏ó</span>
                </div>
            </div>

            <!-- Passenger Actions -->
            <div id="passenger-actions" class="hidden"
                style="margin-top: 20px; padding: 15px; background: white; border-radius: 16px;">
                <p style="font-size: 0.9rem; margin-bottom: 10px; font-weight: 500;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (IoT):</p>
                <div class="action-box" style="flex-wrap: wrap; gap: 10px;">
                    <button class="btn-action btn-bell" onclick="ringBell()" style="min-width: 45%;">
                        üîî ‡∏Å‡∏î‡∏Å‡∏£‡∏¥‡πà‡∏á
                    </button>
                    <button class="btn-action btn-pickup" id="pickup-btn" onclick="startPinning('pickup')"
                        style="min-width: 45%; background: var(--secondary); color: var(--dark);">
                        1. üöï ‡∏õ‡∏±‡∏Å‡∏à‡∏∏‡∏î‡∏£‡∏±‡∏ö
                    </button>
                    <button class="btn-action btn-pin hidden" id="pin-btn" onclick="startPinning('destination')"
                        style="min-width: 45%;">
                        2. üìç ‡∏õ‡∏±‡∏Å‡∏à‡∏∏‡∏î‡∏•‡∏á
                    </button>
                    <button class="btn-action btn-checkin" onclick="checkIn()"
                        style="min-width: 45%; background: var(--success); color: white;">
                        ‚úÖ ‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏ñ‡πÅ‡∏•‡πâ‡∏ß
                    </button>
                    <button class="btn-action btn-sos" onclick="triggerSOS()"
                        style="min-width: 100%; background: #000; color: #FFF;">
                        üö® SOS ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô
                    </button>
                </div>
                <p id="pin-instruction" style="font-size: 0.8rem; color: #8E8E93; margin-top: 8px; display: none;">
                    ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢...</p>
            </div>
        </div>
    </aside>

    <!-- Map Area -->
    <main id="map"></main>

    <!-- Floating Info Card -->
    <div id="info-card" class="floating-card">
        <div class="card-title">
            <span id="display-name">‡∏£‡∏ñ‡∏™‡∏≠‡∏á‡πÅ‡∏ñ‡∏ß</span>
            <span id="display-eta" class="eta-badge">-- ‡∏ô‡∏≤‡∏ó‡∏µ</span>
        </div>

        <div class="detail-row">
            <span class="detail-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</span>
            <span class="detail-value" id="display-status">‡∏£‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏¢‡∏£‡∏ñ</span>
        </div>

        <div class="detail-row">
            <span class="detail-label">‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏ß‡πà‡∏≤‡∏á (IoT):</span>
            <span class="detail-value" id="display-seats" style="color: var(--success); font-weight: bold;">--
                ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</span>
        </div>

        <div class="detail-row">
            <span class="detail-label">‡∏Ñ‡πà‡∏≤‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£:</span>
            <span class="detail-value fare-tag" id="display-fare">-- ‡∏ö‡∏≤‡∏ó</span>
        </div>

        <div class="detail-row" style="margin-top: 15px; border-top: 1px solid #EEE; padding-top: 15px;">
            <span class="detail-label"><span class="pulse-dot"></span> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏≤‡∏à‡∏£:</span>
            <span class="detail-value" id="current-location-text" style="color: var(--primary);">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì
                GPS...</span>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Firebase SDK (Compat version for easier demo integration) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script src="js/app.js"></script>
</body>

</html>